"use strict";import{getStylePropertyBool as n,getStylePropertyFloat as o,getStylePropertyString as c}from"./custom-property";import{detectTouch as m,repeatAnimationFrame as d,initializeViewportDetection as f,callAfterDocumentReady as u,wrapAround as T}from"./common";import{Background as p}from"./part-background.js";import{Navigation as S}from"./part-navigation";import{Pagination as E}from"./part-pagination";import{Indicator as b}from"./part-indicator";import{Selector as L}from"./part-selector.js";import{Slide as g}from"./slide";import{TransitionFade as v,TransitionSlide as w,TransitionScroll as _}from"./transition";const C="slider-simplex",I="slides",P="start",a="view",y="pause",h="scroll",A="--effect-type",N="--duration-time",M="--transition-time",R="--randomize-timing",l="--random-rate",O="--show-background",H="--show-side-slide",D="--create-navigation",k="--create-pagination",B="--create-selector",F="--view-offset";export class SliderSimplex{static create(i){if(i){const t=document.getElementById(i);if(t)return new SliderSimplex(t)}else for(const t of document.getElementsByClassName(C))new SliderSimplex(t);return null}#t;#a;#p;#n;#h;#S;#E;#b;#L;#g;#s;#i;#e=[];#r;#l=null;#c=null;#m=null;#d=null;#f=null;#o=0;#u=0;#T=!1;constructor(i){this.#t=i,this.#a=c(this.#t,A,"fade"),this.#p=o(this.#t,N,8),this.#n=o(this.#t,M,1);const t=n(this.#t,R,null);t?this.#h=o(this.#t,l,10):t===null?this.#h=o(this.#t,l,0):this.#h=0,this.#S=n(this.#t,O,!1),this.#E=n(this.#t,H,!1),this.#b=n(this.#t,D),this.#L=n(this.#t,k),this.#g=n(this.#t,B);const s=o(this.#t,F,100),e=this.#t.querySelector("."+I);this.#s=Array.from(e.getElementsByTagName("li")),this.#i=this.#s.length;for(const r of this.#s)r.dataset.effectType=r.dataset.effectType??this.#a;this.#S&&(this.#f=new p(this.#t,this.#s)),this.#E&&(e.dataset.showSideSlide="true"),this.initSlides(),m(this.#t),f(this.#t,a,s),u(async()=>this.start())}getController(){return{move:t=>this.transition(t,this.#i===2?1:0),next:()=>this.transition(this.#o===this.#i-1?0:this.#o+1,1),prev:()=>this.transition(this.#o===0?this.#i-1:this.#o-1,-1),onTransitionEnd:t=>{this.#l=t}}}initSlides(){this.#a==="scroll"&&1<this.#i&&this.#i<5&&(this.cloneLis(),this.#i===2&&this.cloneLis());const i=this.#t.classList.contains(h);for(let s=0;s<this.#s.length;s+=1){const e=this.#s[s];i&&e.classList.add(h);const r=new g(e,s%this.#i,this.#i);this.#e.push(r)}switch(new ResizeObserver(()=>{for(const s of this.#e)s.onResize()}).observe(this.#t),this.#a){default:case"fade":this.#r=new v(this.#e,this.#n);break;case"slide":this.#r=new w(this.#e,this.#n);break;case"scroll":this.#r=new _(this.#e,this.#n);break}}cloneLis(){for(let i=0;i<this.#i;i+=1){const t=this.#s[i],s=this.#s[i].cloneNode(!0);this.#s.push(s),t.parentNode?.appendChild(s)}}async start(){if(1<this.#i){const t=(s,e)=>this.transition(s,e);new S(this.#t,this.#n,t,this.#b),this.#d=new E(this.#t,this.#i,t,this.#L),this.#c=new L(this.#t,this.#s,this.#i,t,this.#g)}this.#m=new b(this.#t,this.#i),(await Promise.all(this.#e.map(t=>t.isLoaded()))).every(t=>t===!0)?(this.transition(0,0),setTimeout(()=>{this.#t.classList.add(P),d((t,s)=>this.step())},200),console.log(`Slider Simplex (#${this.#t.id}): successfully started`)):console.log(`Slider Simplex (#${this.#t.id}): failed to load media`)}transition(i,t){if(i===-1&&(i=T(this.#o+t,this.#i)),this.#f&&this.#f.transition(i),this.#d&&this.#d.transition(i),this.#m&&this.#m.transition(i),this.#c&&this.#c.transition(i),this.#r.transition(i,t),this.#o=i,this.#T=!0,1<this.#i){const s=this.#e[i].getDuration(this.#p,this.#n,this.#h);this.#u=window.performance.now()+s*1e3}}step(){this.#T&&!this.#r.isTransitioning()&&(this.#l&&this.#l(),this.#T=!1),!(window.performance.now()<this.#u)&&(!this.#t.classList.contains(a)||this.#t.classList.contains(y)||(this.#u=Number.MAX_VALUE,this.transition(-1,1)))}}
//# sourceMappingURL=slider-simplex.min.js.map
