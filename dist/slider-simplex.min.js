"use strict";import{Slide as N}from"./_class-slide";import{asyncTimeout as C,initViewportDetection as F,onLoad as O,initResizeEventHandler as $,onResize as q}from"./_common";import{initButtons as W}from"./_part-button";import{initRivets as U,transitionRivets as j}from"./_part-rivet";import{initIndicators as G,transitionIndicators as J}from"./_part-indicator";import{initThumbnails as K,transitionThumbnails as Q}from"./_part-thumbnail.js";import{initBackgrounds as X,transitionBackgrounds as Y}from"./_part-background.js";import{TransitionFade as Z}from"./_transition-fade";import{TransitionSlide as M}from"./_transition-slide";import{TransitionScroll as x}from"./_transition-scroll";const E="slider-simplex",ee=E+"-frame",H=E+"-slides",te="start",k="view",ne="pause",V="scroll",se=100;export function slider_show(b,c={}){const i=b?document.getElementById(b):document.getElementsByClassName(E)[0];if(!i)return;const m=c?.is_show??!0,T=c?.effect_type??"slide",g=c?.duration_time??8,l=c?.transition_time??1,P=c?.random_timing??!1;let L=!1,S=!1;if(m&&(L=c?.background_visible??!0,S=c?.side_slide_visible??!1,i.style.setProperty("--transition-time",`${l}s`),T!=="scroll"&&(S=!1),S)){L=!1;const e=i.querySelector("."+H);e.style.overflow="visible"}const r=Array.prototype.slice.call(i.querySelectorAll(`.${H} > li`)),t=r.length,u=[];let p,v=null;const z=B();m&&L&&X(t,i,r),z&&setTimeout(h,100);function h(){w()||setTimeout(h,100)}if(m){const e=i.getElementsByClassName(ee)[0];0<navigator.maxTouchPoints&&e.addEventListener("pointerenter",n=>{const s=n.pointerType==="mouse"?"remove":"add";e.classList[s]("touch")},{once:!0})}O(()=>{$(),m&&(W(l,t,i,a),K(b,t),G(t,i),U(b,t,i,a)),F(i,k,se),a(0,0),console.log(`Slider Simplex - Show (#${b}): started`),setTimeout(()=>i.classList.add(te),0)});function B(){m&&T==="scroll"&&1<t&&t<5&&(I(),t===2&&I());const e=i.classList.contains(V);let n=!1;for(let s=0;s<r.length;s+=1){e&&r[s].classList.add(V);const f=new N(r[s],s);f.getType()==="video"&&(n=!0),u.push(f)}switch(q(w,!0),T){case"slide":p=new M(t,r,l);break;case"scroll":p=new x(t,r,l);break;case"fade":p=new Z(t,r,l);break;default:p=new M(t,r,l);break}return n}function w(){let e=!0;for(const n of u)n.onResize()||(e=!1);return e}function I(){for(let e=0;e<t;e+=1){const n=r[e],s=n.cloneNode(!0);r.push(s),n.parentNode?.appendChild(s)}}let o=0,d=null,_=0,y=null;async function a(e,n){[e,n]=A(e,n);const s=window.performance.now();if(n!==0&&s-_<l*1e3){y&&clearTimeout(y),y=setTimeout(()=>a(e,n),l*1e3-(s-_));return}_=s;for(const f of u)f.onPreDisplay(e,t);for(const f of u)f.transition(e,t);m&&(Y(e,t),Q(e),J(e),j(e)),await p.transition(e,n),v&&v(),o=e,D(e)}async function D(e){for(const s of u)s.display(e,t);if(t===1)return;const n=u[e].getDuration(g,l,P);d&&d.clear(),d=C(Math.ceil(n*1e3),R),await d.set()}async function R(){i.classList.contains(k)&&!i.classList.contains(ne)?a(null,1):C(g*1e3,R).set()}function A(e,n){if(e===null)e=o+n,t-1<e&&(e=0),e<0&&(e=t-1);else if(n===0&&o!==e){const s=o<e?e-o:e+t-o;n=(e<o?o-e:o+t-e)<s?-1:1}return[e,n]}return{move:e=>a(e,t===2?1:0),next:()=>a(o===t-1?0:o+1,1),prev:()=>a(o===0?t-1:o-1,-1),onTransitionEnd:e=>{v=e}}}
//# sourceMappingURL=slider-simplex.min.js.map
