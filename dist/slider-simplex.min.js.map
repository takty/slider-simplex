{
  "version": 3,
  "sources": ["../src/slider-simplex.ts"],
  "sourcesContent": ["/**\n * Slider Simplex\n *\n * @author Takuto Yanagida\n * @version 2025-03-26\n */\n\nimport { getStylePropertyBool, getStylePropertyFloat, getStylePropertyString } from './custom-property';\nimport { detectTouch, repeatAnimationFrame, initializeViewportDetection, callAfterDocumentReady, wrapAround } from './common';\n\nimport { Background } from './part-background.js';\nimport { Navigation } from './part-navigation';\nimport { Pagination } from './part-pagination';\nimport { Indicator } from './part-indicator';\nimport { Selector } from './part-selector.js';\n\nimport { Slide } from './slide';\nimport { Transition, TransitionFade, TransitionSlide, TransitionScroll } from './transition';\n\nconst NS          = 'slider-simplex';\nconst CLS_SLIDES  = 'slides';\n\nconst CLS_START   = 'start';\nconst CLS_VIEW    = 'view';\nconst CLS_PAUSE   = 'pause';\nconst CLS_SCROLL  = 'scroll';\nconst OFFSET_VIEW = 100;\n\nconst CP_EFFECT_TYPE      = '--effect-type';\nconst CP_DURATION_TIME    = '--duration-time';\nconst CP_TRANSITION_TIME  = '--transition-time';\nconst CP_RANDOMIZE_TIMING = '--randomize-timing';\n\nconst CP_SHOW_BACKGROUND  = '--show-background';\nconst CP_SHOW_SIDE_SLIDE  = '--show-side-slide';\n\nconst CP_CREATE_NAVIGATION = '--create-navigation';\nconst CP_CREATE_PAGINATION = '--create-pagination';\nconst CP_CREATE_SELECTOR   = '--create-selector';\n\nexport class SliderSimplex {\n\n\tstatic create(id: string | null): SliderSimplex | null {\n\t\tif (id) {\n\t\t\tconst r: HTMLElement = document.getElementById(id) as HTMLElement;\n\t\t\tif (r) {\n\t\t\t\treturn new SliderSimplex(r);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const r of document.getElementsByClassName(NS)) {\n\t\t\t\tnew SliderSimplex(r as HTMLElement);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t#root: HTMLElement;\n\n\t#effectType      : string\n\t#timeDur         : number\n\t#timeTran        : number\n\t#randomizeTiming : boolean\n\n\t#showBackground  : boolean;\n\t#showSideSlide   : boolean;\n\n\t#createNavigation: boolean;\n\t#createPagination: boolean;\n\t#createSelector  : boolean;\n\n\t#lis    : HTMLLIElement[];\n\t#size   : number;\n\t#slides : Slide[] = [];\n\t#effect!: Transition;\n\n\t#onTransitionEnd: (() => void) | null = null;\n\n\t#selector  : Selector   | null = null;\n\t#indicator : Indicator  | null = null;\n\t#pagination: Pagination | null = null;\n\t#background: Background | null = null;\n\n\t#curIdx      : number  = 0;\n\t#nextStepTime: number  = 0;\n\t#isWaiting   : boolean = false;\n\n\tconstructor(root: HTMLElement) {\n\t\tthis.#root = root;\n\n\t\tthis.#effectType       = getStylePropertyString(this.#root, CP_EFFECT_TYPE, 'fade');\n\t\tthis.#timeDur          = getStylePropertyFloat(this.#root, CP_DURATION_TIME, 8);\n\t\tthis.#timeTran         = getStylePropertyFloat(this.#root, CP_TRANSITION_TIME, 1);\n\t\tthis.#randomizeTiming  = getStylePropertyBool(this.#root, CP_RANDOMIZE_TIMING);\n\n\t\tthis.#showBackground   = getStylePropertyBool(this.#root, CP_SHOW_BACKGROUND, false);\n\t\tthis.#showSideSlide    = getStylePropertyBool(this.#root, CP_SHOW_SIDE_SLIDE, false);\n\n\t\tthis.#createNavigation = getStylePropertyBool(this.#root, CP_CREATE_NAVIGATION);\n\t\tthis.#createPagination = getStylePropertyBool(this.#root, CP_CREATE_PAGINATION);\n\t\tthis.#createSelector   = getStylePropertyBool(this.#root, CP_CREATE_SELECTOR);\n\n\t\tconst ul = this.#root.querySelector('.' + CLS_SLIDES) as HTMLElement;\n\n\t\tthis.#lis  = Array.from(ul.getElementsByTagName('li'));\n\t\tthis.#size = this.#lis.length;\n\n\t\tfor (const li of this.#lis) {\n\t\t\tli.dataset.effectType = li.dataset.effectType ?? this.#effectType;\n\t\t}\n\t\tif (this.#showBackground) {\n\t\t\tthis.#background = new Background(this.#root, this.#lis);\n\t\t}\n\t\tif (this.#showSideSlide) {\n\t\t\tul.style.overflow = 'visible';\n\t\t}\n\t\tthis.initSlides();\n\t\tdetectTouch(this.#root);\n\t\tinitializeViewportDetection(this.#root, CLS_VIEW, OFFSET_VIEW);\n\t\tcallAfterDocumentReady((): void => this.start());\n\t}\n\n\tgetController() {\n\t\tconst fs = {\n\t\t\tmove: (idx: number): void => this.transition(idx, this.#size === 2 ? 1 : 0),\n\t\t\tnext: (): void => this.transition((this.#curIdx === this.#size - 1) ? 0               : (this.#curIdx + 1),  1),\n\t\t\tprev: (): void => this.transition((this.#curIdx === 0            ) ? (this.#size - 1) : (this.#curIdx - 1), -1),\n\n\t\t\tonTransitionEnd: (fn: () => void): void => { this.#onTransitionEnd = fn; }\n\t\t};\n\t\treturn fs;\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tprivate initSlides(): void {\n\t\tif (this.#effectType === 'scroll' && 1 < this.#size && this.#size < 5) {\n\t\t\tthis.cloneLis();\n\t\t\tif (this.#size === 2) {\n\t\t\t\tthis.cloneLis();\n\t\t\t}\n\t\t}\n\t\tconst isScroll: boolean = this.#root.classList.contains(CLS_SCROLL);\n\n\t\tfor (let i: number = 0; i < this.#lis.length; i += 1) {\n\t\t\tconst li: HTMLElement = this.#lis[i];\n\t\t\tif (isScroll) {\n\t\t\t\tli.classList.add(CLS_SCROLL);\n\t\t\t}\n\t\t\tconst slide = new Slide(li, i % this.#size, this.#size);\n\t\t\tthis.#slides.push(slide);\n\t\t}\n\t\tconst ro = new ResizeObserver((): void => {\n\t\t\tfor (const s of this.#slides) {\n\t\t\t\ts.onResize();\n\t\t\t}\n\t\t});\n\t\tro.observe(this.#root);\n\n\t\tswitch (this.#effectType) {\n\t\t\tdefault      :\n\t\t\tcase 'fade'  : this.#effect = new TransitionFade(this.#slides, this.#timeTran); break;\n\t\t\tcase 'slide' : this.#effect = new TransitionSlide(this.#slides, this.#timeTran); break;\n\t\t\tcase 'scroll': this.#effect = new TransitionScroll(this.#slides, this.#timeTran); break;\n\t\t}\n\t}\n\n\tprivate cloneLis(): void {\n\t\tfor (let i: number = 0; i < this.#size; i += 1) {\n\t\t\tconst li: HTMLLIElement = this.#lis[i];\n\t\t\tconst nls = this.#lis[i].cloneNode(true) as HTMLLIElement;\n\t\t\tthis.#lis.push(nls);\n\t\t\tli.parentNode?.appendChild(nls);\n\t\t}\n\t}\n\n\tprivate start(): void {\n\t\tif (1 < this.#size) {\n\t\t\tconst fn = (idx: number, dir: -1 | 0 | 1) => this.transition(idx, dir);\n\n\t\t\tnew Navigation(this.#root, this.#timeTran, fn, this.#createNavigation);\n\t\t\tthis.#pagination = new Pagination(this.#root, this.#size, fn, this.#createPagination);\n\t\t\tthis.#selector   = new Selector(this.#root, this.#lis, this.#size, fn, this.#createSelector);\n\t\t}\n\t\tthis.#indicator = new Indicator(this.#root, this.#size);\n\n\t\tthis.transition(0, 0);\n\t\tsetTimeout((): void => this.#root.classList.add(CLS_START), 200);\n\t\tconsole.log(`Slider Simplex (#${this.#root.id}): started`);\n\n\t\trepeatAnimationFrame((_t: number, _dt: number): void => this.step());\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tprivate transition(idx: number, dir: -1 | 0 | 1): void {\n\t\tif (idx === -1) {\n\t\t\tidx = wrapAround(this.#curIdx + dir, this.#size);\n\t\t}\n\t\tif (this.#background) this.#background.transition(idx);\n\t\tif (this.#pagination) this.#pagination.transition(idx);\n\t\tif (this.#indicator)  this.#indicator.transition(idx);\n\t\tif (this.#selector)   this.#selector.transition(idx);\n\n\t\tthis.#effect.transition(idx, dir);\n\t\tthis.#curIdx    = idx;\n\t\tthis.#isWaiting = true;\n\n\t\tif (1 < this.#size) {\n\t\t\tconst dt: number = this.#slides[idx].getDuration(this.#timeDur, this.#timeTran, this.#randomizeTiming);\n\t\t\tthis.#nextStepTime = window.performance.now() + dt * 1000;\n\t\t}\n\t}\n\n\tprivate step(): void {\n\t\tif (this.#isWaiting && !this.#effect.isTransitioning()) {\n\t\t\tif (this.#onTransitionEnd) this.#onTransitionEnd();\n\t\t\tthis.#isWaiting = false;\n\t\t}\n\t\tif (window.performance.now() < this.#nextStepTime) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.#root.classList.contains(CLS_VIEW) || this.#root.classList.contains(CLS_PAUSE)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.#nextStepTime = Number.MAX_VALUE;\n\t\tthis.transition(-1, 1);\n\t}\n\n}\n"],
  "mappings": "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",
  "names": ["getStylePropertyBool", "getStylePropertyFloat", "getStylePropertyString", "detectTouch", "repeatAnimationFrame", "initializeViewportDetection", "callAfterDocumentReady", "wrapAround", "Background", "Navigation", "Pagination", "Indicator", "Selector", "Slide", "TransitionFade", "TransitionSlide", "TransitionScroll", "NS", "CLS_SLIDES", "CLS_START", "CLS_VIEW", "CLS_PAUSE", "CLS_SCROLL", "OFFSET_VIEW", "CP_EFFECT_TYPE", "CP_DURATION_TIME", "CP_TRANSITION_TIME", "CP_RANDOMIZE_TIMING", "CP_SHOW_BACKGROUND", "CP_SHOW_SIDE_SLIDE", "CP_CREATE_NAVIGATION", "CP_CREATE_PAGINATION", "CP_CREATE_SELECTOR", "id", "r", "#root", "#effectType", "#timeDur", "#timeTran", "#randomizeTiming", "#showBackground", "#showSideSlide", "#createNavigation", "#createPagination", "#createSelector", "#lis", "#size", "#slides", "#effect", "#onTransitionEnd", "#selector", "#indicator", "#pagination", "#background", "#curIdx", "#nextStepTime", "#isWaiting", "root", "ul", "li", "idx", "fn", "isScroll", "i", "slide", "nls", "dir", "_t", "_dt", "dt"]
}
