/**
 * Slider Simplex
 *
 * @author Takuto Yanagida
 * @version 2025-03-17
 */

.slider-simplex {
	--effect-type     : slide;
	--duration-time   : 8s;
	--transition-time : 1s;
	--randomize-timing: false;

	--show-background: false;
	--show-side-slide: false;

	--create-navigation: true;
	--create-pagination: true;
	--create-selector  : false;

	// -------------------------------------------------------------------------

	--size-width     : 48rem;
	--size-height-min: 14rem;
	--size-height-max: 80vh;
	--color-frame    : #fff6;

    --slide-ratio     : 12/5;
	--slide-size      : cover;
	--slide-zoom      : 1.05;
	--slide-color-dual: #fff6;

	--caption-color           : #fff;
	--caption-color-shadow    : #000;
	--caption-color-bg        : #0006;
	--caption-size-font-circle: 1.85rem;
	--caption-size-font-line  : 1.85rem;

	--btn-size            : 2rem;
	--btn-size-mark       : 0.75rem;
	--btn-color           : transparent;
	--btn-color-hover     : #0006;
	--btn-mark-color      : #fffa;
	--btn-mark-color-hover: #fff;
	--btn-mark-path       : polygon(30% 10%, 30% 90%, 95% 50%);

	--rivet-size-width      : 0.5rem;
	--rivet-size-height     : 0.5rem;
	--rivet-size-radius     : 50%;
	--rivet-area-size-width : 1.5rem;
	--rivet-area-size-height: 1.5rem;
	--rivet-color           : #fffe;
	--rivet-color-selected  : #bbbe;
	--rivet-shadow          : 0 1px 2px #0006 inset;

	--rivet-inset           : 9999vh auto auto auto;
	@media screen and (min-width: 600px) {  // for-ta
		--rivet-inset: 0 auto auto auto;
	}
}


// -----------------------------------------------------------------------------


.slider-simplex {
	position  : relative;
	box-sizing: border-box;

	:is(*, *::before, *::after) {
		box-sizing: inherit;
		margin    : 0;
		padding   : 0;
	}

	overflow: hidden;
	opacity: 0;
	&.start {
		opacity   : 1;
		transition: opacity 0.4s;
	}

	display              : grid;
	grid-template-columns: calc((100% - var(--size-width)) / 2) auto calc((100% - var(--size-width)) / 2);
	grid-template-rows   : auto auto;

	gap: 0.5rem 0;
}


// -----------------------------------------------------------------------------


.slider-simplex {

	.frame {
		grid-area: 1/2/2/3;

		background-color: var(--color-frame);

		width: min(100%, var(--size-width));

		min-height: var(--size-height-min);
		max-height: var(--size-height-max);

		position: relative;
		&::before {
			content     : '';
			display     : block;
			width       : 100%;
			aspect-ratio: var(--slide-ratio);
		}
	}
}

.slider-simplex .slides {
	position: absolute;
	inset   : 0;

	list-style: none;
	overflow  : hidden;

	width : 100%;
	height: 100%;

	display : grid;

	> li {
		grid-area: 1/1/2/2;

		display: grid;

		overflow           : hidden;
		backface-visibility: hidden;
		opacity            : 0;

		> * {
			grid-area: 1/1/2/2;
		}

		> a {
			display: grid;

			text-decoration: none;

			> * {
				grid-area: 1/1/2/2;
			}
		}
	}
}


// -----------------------------------------------------------------------------


.slider-simplex .image {
	position: absolute;
	inset   : 0;

	&:not(.scroll) {
		transition: transform 5s;

		&.display {
			transition: transform 10s;
			transform : scale(var(--slide-zoom));
		}
	}

	> img {
		object-fit: var(--slide-size);

		width : 100%;
		height: 100%;

		@supports (-webkit-appearance: none) and (not (-moz-appearance: none)) and (not (font: -apple-system-body)) {
			image-rendering: -webkit-optimize-contrast;
		}
	}

	&.scroll {
		> img {
			object-fit: cover;
			transition: object-position 10s;

			&:first-child {
				object-position: center top;
			}
		}
		&.display > img:first-child {
			object-position: center bottom;
		}
	}

	&.dual {
		display         : flex;
		background-color: var(--slide-color-dual);

		> img {
			width: 50%;

			&:last-child {
				opacity   : 0;
				transition: opacity 1s;
			}
		}
		&.display > img:last-child {
			opacity: 1;
		}
		&.scroll {
			> img:last-child {
				object-position: center bottom;
			}
			&.display > img:last-child {
				transition     : opacity 1s, object-position 9s 1s;
				object-position: center top;
			}
		}
	}
}


// -----------------------------------------------------------------------------


.slider-simplex .video {
	position: relative;
	height  : 100%;

	video {
		position  : absolute;
		width     : 100%;
		height    : 100%;
		max-width : initial;
		max-height: initial;
		object-fit: cover;
	}
	.width {
		width    : 100%;
		top      : 50%;
		transform: translateY(-50%);
	}
	.height {
		height   : 100%;
		left     : 50%;
		transform: translateX(-50%);
	}
}


// -----------------------------------------------------------------------------


.slider-simplex {

	.caption {
		position      : relative;
		pointer-events: none;

		color      : var(--caption-color);
		text-shadow: 0 0 0.5rem var(--caption-color-shadow);
		line-height: 1.25;

		font-feature-settings: 'pkna' 1;

		transition-duration: var(--transition-time, 1s);
		transition-property: opacity;

		opacity: 0;
		&.display {
			opacity: 1;
		}

		span > span { display: inline-block; }

		// ----

		&.subtitle {
			align-self: end;

			background-color: var(--caption-color-bg);
			backdrop-filter : blur(20px) saturate(180%);

			padding-inline: 1rem;
			padding-block : clamp(0.5rem, (100vw - 600px) * 9999, 0.85rem);
		}

		// ----

		&.line {
			align-self: end;
			min-height: 50%;

			display        : flex;
			flex-direction : column;
			align-items    : flex-start;
			justify-content: center;
			gap            : 1rem;

			padding: 0.85rem 2rem;

			> div > span {
				display             : inline;
				box-decoration-break: clone;

				background-color: var(--caption-color-bg);
				font-size       : var(--caption-size-font-line);
				line-height     : 1.5;
			}
		}

		// ----

		&.circle {
			margin-inline: var(--btn-size);

			display        : flex;
			flex-direction : column;
			align-items    : center;
			justify-content: center;
			gap            : 0.5rem;

			padding: 0.85rem 2rem;

			background-image: radial-gradient(circle closest-side at center center, var(--caption-color-bg) 50%, transparent 51%);
		}

		&:is(.circle, .circle > div) {
			text-align : center;
			line-height: 1.35;
			font-size  : var(--caption-size-font-circle);
		}
	}


	// -------------------------------------------------------------------------


	.background {
		grid-area: 1/1/2/4;

		pointer-events: none;
		overflow      : hidden;

		position: relative;
		img {
			position: absolute;
			inset   : 0;

			max-width : unset;
			max-height: unset;

			width     : 100%;
			height    : 100%;
			object-fit: cover;
			min-height: 0;

			filter          : blur(4px);
			transform       : scale(2, 2);
			transform-origin: center center;

			transition-duration: calc(var(--transition-time, 1s) * 2);
			transition-property: opacity;

			opacity: 0;
			&.visible {
				opacity: 0.3;
			}
		}
	}


	// -------------------------------------------------------------------------


	.navigation {  // Previous/Next Button
		grid-area: 1/2/2/3;
		position : relative;

		pointer-events: none;

		display              : grid;
		grid-template-columns: auto 1fr auto;

		> button {
			appearance: none;
			background: none;
			border    : none;

			cursor: pointer;
			pointer-events: auto;

			width: var(--btn-size);

			transition: opacity 0.2s;

			display      : grid;
			align-items  : center;
			justify-items: center;

			&::before,
			&::after {
				content : '';
				position: relative;

				grid-area: 1/1/2/2;

				transition: all 0.2s;
			}

			&::before {
				width : var(--btn-size);
				height: var(--btn-size);

				background-color: var(--btn-color);
			}

			&::after {
				width : var(--btn-size-mark);
				height: var(--btn-size-mark);

				clip-path       : var(--btn-mark-path);
				background-color: var(--btn-mark-color);
			}

			&.active {
				&::before { background-color: var(--btn-color-hover); }
				&::after  { background-color: var(--btn-mark-color-hover); }
			}

			&:nth-of-type(1) {
				grid-column: 1/2;
				// inset-inline-start: 0;
				transform         : rotate(180deg);
			}

			&:nth-of-type(2) {
				grid-column: 3/4;
				// inset-inline-end: 0;
			}

			&.disabled {
				opacity: 0;
				cursor : default;
			}
		}
	}


	// -------------------------------------------------------------------------


	.pagination {
		grid-area: 1/2/2/3;
		position : relative;

		width: min(100%, var(--size-width));

		pointer-events: none;

		ol {
			display        : flex;
			align-items    : flex-start;
			justify-content: flex-end;
		}

		li {
			display    : inline-grid;
			place-items: center;
			width      : var(--rivet-area-size-width);
			height     : var(--rivet-area-size-height);

			cursor        : pointer;
			pointer-events: auto;

			&::after {
				content: '';
				width  : var(--rivet-size-width);
				height : var(--rivet-size-height);

				background-color: var(--rivet-color);
				box-shadow      : var(--rivet-shadow);
			}

			&.visible {
				pointer-events: none;
				&::after { background-color: var(--rivet-color-selected); }
			}
		}
	}


	// -------------------------------------------------------------------------


	.selector {
		grid-area: 2/2/3/3;

		ol {
			display        : flex;
			justify-content: center;
			gap            : 0.5rem;
			flex-wrap      : wrap;
		}

		li {
			display    : inline-grid;
			place-items: center;

			width       : 4rem;
			aspect-ratio: 1/1;

			cursor        : pointer;
			pointer-events: auto;

			&.visible {
				pointer-events: none;
				opacity       : 0.3;
			}
		}

		img {
			grid-area: 1/1/-1/-1;

			width     : 100%;
			height    : 100%;
			object-fit: cover;
			min-height: 0;
		}
	}

}
